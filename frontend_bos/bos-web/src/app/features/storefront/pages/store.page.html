<section class="space-y-8">
  <div class="card space-y-4">
    <h2 class="text-lg font-semibold text-[var(--text-strong)]">Find products</h2>

    <div class="flex flex-col gap-4">
      <div class="flex flex-col gap-2">
        <label class="text-sm text-[var(--text)]">Search</label>
        <input
          type="text"
          class="w-full border border-[var(--border-strong)] rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--secondary)] bg-[var(--surface)] placeholder:text-[var(--text-subtle)]"
          placeholder="e.g. pizza, empanada, drink..."
          [ngModel]="search()"
          (ngModelChange)="search.set($event)"
        />
      </div>

      <div class="flex flex-col gap-2">
        <label class="text-sm text-[var(--text)]">Filter by price</label>
        <div class="grid grid-cols-2 gap-3">
          <div class="flex flex-col gap-1">
            <span class="text-xs text-[var(--text-subtle)]">Min</span>
            <input
              type="number"
              class="w-full border border-[var(--border-strong)] rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--secondary)] bg-[var(--surface)]"
              [ngModel]="minFilter()"
              (ngModelChange)="minFilter.set(+($event ?? minPrice))"
              [min]="0"
            />
          </div>
          <div class="flex flex-col gap-1">
            <span class="text-xs text-[var(--text-subtle)]">Max</span>
            <input
              type="number"
              class="w-full border border-[var(--border-strong)] rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--secondary)] bg-[var(--surface)]"
              [ngModel]="maxFilter()"
              (ngModelChange)="maxFilter.set(+($event ?? maxPrice))"
              [min]="0"
            />
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-2">
        <p class="text-sm text-[var(--text)]">Categories</p>
        <div class="flex flex-wrap gap-2">
          <button
            *ngFor="let cat of categories()"
            class="px-3 py-2 rounded-full border text-sm transition"
            [ngClass]="
              selectedCategory() === cat
                ? 'bg-[var(--primary)] text-white border-[var(--primary)]'
                : 'text-[var(--text)] border-[var(--border-strong)] bg-[var(--surface)]'
            "
            (click)="setCategory(cat)"
          >
            {{ cat }}
          </button>
        </div>
      </div>

      <button
        class="self-start px-4 py-2 rounded-lg border border-[var(--border-strong)] text-sm text-[var(--text)] hover:bg-[var(--surface)]"
        (click)="resetFilters()"
      >
        Clear filters
      </button>
    </div>
  </div>


  <section *ngIf="selectedCategory() === 'Combos' || (selectedCategory() === 'All' && promoItems().length)" class="space-y-4">
    <div class="flex items-center gap-3">
      <div class="w-10 h-1 rounded-full bg-[var(--secondary)]"></div>
      <h3 class="text-xl font-semibold text-[var(--accent)]">Combos</h3>
    </div>
    <div class="grid md:grid-cols-3 gap-4">
      <app-promo-card
        *ngFor="let promo of promoItems()"
        [promo]="promo"
      />
    </div>
  </section>

  <section *ngIf="selectedCategory() !== 'Combos'" class="space-y-4">
    <h3 class="text-xl font-semibold text-[var(--text-strong)]">Products</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
      <app-product-card
        *ngFor="let product of filteredProducts(); trackBy: trackById"
        [product]="product"
        (added)="onAdded($event)"
      />
    </div>
  </section>
</section>

<app-toast></app-toast>